<!DOCTYPE html>
<html>
<head>
    <title>Hello eZ! - Demo application - eZ Publish REST API v2 + YUI + Pure + HTML5</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,700">
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.2.0/pure-min.css">
    <link rel="stylesheet" href="css/core.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="http://yui.yahooapis.com/3.10.3/build/yui/yui-min.js"></script>
    <script src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
</head>
<body>
    <script>
    YUI({
        //filter: 'raw',
        modules: {
            'gallery-base64': {
                fullpath: "js/gallery-base64-min.js"
            },
            'ezp-rest-client': {
                fullpath: "js/ezp-rest-client.js",
                requires: ['io', 'io-xdr', 'json', 'gallery-base64']
            },
            'hello-app': {
                fullpath: "js/hello-app.js",
                requires: ['app', 'app-transitions', 'transition', 'handlebars', 'node-event-html5', 'ezp-rest-client']
            }
        }
    }).use('hello-app', function (Y) {
        var app;

        navigator.getMedia = ( navigator.getUserMedia ||
            navigator.webkitGetUserMedia ||
            navigator.mozGetUserMedia ||
            navigator.msGetUserMedia
        );
    
        app = new Y.HelloApp({
            serverRouting: false,
            root: '/hello-ez/',
            viewContainer: '#hello-app',
            container: '#hello-app',
            transitions: {
                navigate: 'slideLeft',
                toChild: 'slideLeft',
                toParent: 'slideRight'
            }
        });
        app.render().dispatch();
    });
    </script>
    <div id="hello-app" class="application"></div>


    <script type="text/x-handlebars-template" id="homeview-tpl">
        <h1 class="view-title">Welcome to the <strong>Hello eZ!</strong> demo application</h1>
        <article class="text">
            <p>This is a demo application of <a href="https://confluence.ez.no/display/EZP/REST+API">the eZ Publish REST API v2</a>. It is also build with <a href="http://yuilibrary.com/yui/docs/app/">the YUI App Framework</a> and <a href="http://purecss.io/">the Pure CSS framework</a>.</p>
            <h2>What it does</h2>
            <p>By going through the following steps, you will create a simplified profile containing a picture taken with your webcam, the location send by your browser and others manually filled fields on an eZ Publish website (<a href="http://www.planet-ezpublish.fr">Planet eZ Publish.fr</a> by default). This profile will be only visible on <a href="http://demo.planet-ezpublish.fr/">the demo page of Planet eZ Publish.fr</a>, if you want me to remove you profile, just <a href="mailto:damien+helloez@pobel.fr">drop an email!</a>.
            <h2>Steps</h2>
            <ol>
                <li>Small introduction: this is what you are reading right now!</li>
                <li>Checks / configuration: it will ask for the permission to use your webcam and to geo-locate you. In this step, you can also tweak the eZ Publish backend to use</li>
                <li>Capture: if you allowed the browser to use the webcam, in this step you will be able to take a picture with your webcam, otherwise it is skipped</li>
                <li>Details: here you'll have to fill some details to fill your profile</li>
                <li>Results: this step will display the log of what happens behind the scene regarding the REST API</li>
            </ol>
        </article>
        <p class="button-bar button-bar-next"><a href="#/checks" class="pure-button pure-button-primary" data-icon="&#xe002;">Start</a></p>
    </script>

    <script type="text/x-handlebars-template" id="checksview-tpl">
        <h1 class="view-title">Configuration</h1>
        <div class="pure-g-r">
            <section class="pure-u-1-2">
                <div class="inner-content-right">
                    <p>Please allow your browser to access the following resources, if you don't do that (or those resources are not available), the demo will still works but it will be less fun :-)</p>
                    <ul class="system-check">
                        <li id="webcam-check">Your webcam</li>
                        <li id="geoloc-check">Your location</li>
                    </ul>
                </div>
            </section><!--
            --><section class="pure-u-1-2">
                <div class="inner-content-left">
                    <form class="pure-form pure-form-stacked">
                        <fieldset>
                            <legend>eZ Publish backend</legend>
                            <label for="resturl">REST root URL</label>
                            <input type="text" name="resturl" id="resturl" class="pure-input-1" required value="{{configuration.restUrl}}">
                            <label for="login">Login</label>
                            <input type="text" name="login" id="login" class="pure-input-1" required value="{{configuration.login}}">
                            <label for="password">Password</label>
                            <input type="password" name="password" id="password" class="pure-input-1" value="{{configuration.password}}">
                        </fieldset>
                    </form>
                    <ul class="system-check">
                        <li id="ezpublish-check">Access to eZ Publish</li>
                    </ul>
                </div>
            </section>
        </div>
        <p class="button-bar button-bar-next"><button class="pure-button pure-button-primary" data-icon="&#xe002;" id="capture-details-button">Go the next step</button></p>
    </script>

    <script type="text/x-handlebars-template" id="captureview-tpl">
    <h1 class="view-title">Please smile!</h1>
    <div class="pure-g-r">
        <section class="webcam-view pure-u-1-2">
            <p class="preview">
                <video id="webcam-video"></video>
                <canvas></canvas>
            </p>
            <p class="help">You can take several picture until you feel satisfied with the one on the right!</p>
            <p class="button-bar">
                <button id="capture-button" class="pure-button pure-button-primary " data-icon="&#xe000;" disabled>Take a picture</button>
            </p>
        </section><!--
        --><section class="picture-view pure-u-1-2">
            <p class="preview image-result"><img src="{{picture}}" alt="" /></p>
            <p class="help help-next">Happy, with the result?</p>
            <p class="button-bar button-bar-next">
                <a href="#/details" id="next-step-button" class="pure-button pure-button-primary " data-icon="&#xe002;" disabled>Go to the next step</a>
            </p>
        </section>
    </div>
    </script>

    <script type="text/x-handlebars-template" id="detailsview-tpl">
    <h1 class="view-title">Your profile</h1>
    <div class="pure-g-r">
        <section class="picture-view pure-u-1-2">
            {{#if lat}}
                <label>Location</label>
                <div id="map-location" class="map"></div>
            {{else}}
                {{#if picture}}
                    <p>Your picture:</p>
                    <p class="image-result"><img src="{{picture}}" alt="Your picture"></p>
                {{else}}
                    <p>Don't have a webcam? Or maybe you are too shy, if you change your mind, it is still time <a href="#/checks">to enable it</a> and take a beautiful picture :-)</p>
                {{/if}}
            {{/if}}
        </form>
        </section><!--
        --><section class="pure-u-1-2">
            <form class="pure-form pure-form-stacked">
                <fieldset class="pure-g-r">
                    <p class="pure-u-1-2">
                        <label for="name">Your name*:</label>
                        <input type="text" id="name" name="name" value="{{name}}" required placeholder="Please fill your name" class="pure-u-3-4">
                    </p><!--
                    --><p class="pure-u-1-2">
                        <label for="twitter">Your Twitter account:</label>
                        <input type="text" id="twitter" name="twitter" value="{{twitter}}" placeholder="@login" class="pure-u-3-4">
                    </p>
                </fieldset>
                <fieldset>
                    <label for="mood">Any thought?</label>
                    <textarea id="mood" name="mood" rows="3" placeholder="You can write here whatever you want (please no ads, no offensive sentence, ...)" class="pure-input-1">{{mood}}</textarea>
                </fieldset>
            </form>
        </section>
    </div>
    <p class="button-bar button-bar-next">
        <button id="another-picture" class="pure-button" data-icon="&#xe000;">Take another picture</button>
        <button id="send-ezpublish" class="pure-button pure-button-primary" data-icon="&#xe002;" disabled>Send to eZ Publish</button>
    </p>

    </script>
</body>
</html>
