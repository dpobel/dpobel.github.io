<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Using the eZ Publish 5 REST API - eZ Summer Camp 2013</title>

        <meta name="description" content="With the new eZ version 5 comes the new Public API which has also the REST version. The REST API will be the future corner stone for interfaces and integrations. In the workshop we will practice several common usage examples.">
		<meta name="author" content="Damien Pobel &mdash; eZ Systems">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/ez.css" id="theme">
		<link rel="stylesheet" href="lib/css/icomoon.css">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
                    <img src="assets/ez.png" alt="eZ" />
                    <h1>eZ Publish REST API</h1>

                    <p>Available online at:<br><a href="http://j.mp/ez-sc-2013-rest-api">http://j.mp/ez-sc-2013-rest-api</a></p>
				</section>

				<section>
                    <h2>Me</h2>

                    <ul>
                        <li>eZ Community member since 2005</li>
                        <li>Part of the eZ Engineering team since 2011</li>
                        <li><em>Lead engineer User Interface</em> at eZ</li>
                    </ul>

                    <ul class="social">
                        <li class="twitter"><a href="https://twitter.com/dpobel" data-icon="&#xe001"><span>@dpobel</span></a></li>
                        <li class="gplus"><a href="https://plus.google.com/u/0/102664237253121682993/posts?rel=author" data-icon="&#xe000"><span>+Damien Pobel</span></a></li>
                        <li class="github"><a href="http://github.com/dpobel" data-icon="&#xe003"><span>Github</span></a></li>
                        <li class="linkedin"><a href="http://fr.linkedin.com/in/dpobel" data-icon="&#xe004"><span>Linkedin</span></a></li>
                        <li class="blog"><a href="http://damien.pobel.fr" data-icon="&#xe005"><span>Blog</span></a></li>
                    </ul>
				</section>


				<section data-markdown>
                    <script type="text/template">
                        ## REST API ?

                        * REpresentational State Transfer
                        * In short terms API over HTTP
                        * Manipulate resources (~URI) with HTTP verbs
                        * Get the result through the HTTP response
                    </script>
                </section>

				<section data-markdown>
                    <script type="text/template">
                        ## REST API in eZ Publish 4.x

                        * eZ Publish 4.x has a REST API
                        * Read only
                        * Very limited scope / incomplete
                    </script>
				</section>


				<section data-markdown>
                    <script type="text/template">
                        ## REST API in eZ Publish 5

                        * read / write
                        * allows to handle almost everything in the repository (Content, Location, Types, ...)
                        * support Basic Auth and Session auth
                        * XML or JSON support in input and output
                        * Hypermedia as the Engine of Application State (HATEOAS)
                        * Specifications: http://j.mp/ezpublish-rest-spec
                    </script>
                    <aside class="notes">api v2, completely different, almost "feature" complete</aside>
				</section>


				<section>
                    <p class="architecture"><img src="assets/architecture.png" alt="eZ Publish 5 architecture"></p>
				</section>

				<section data-markdown>
                    <script type="text/template">
                        ## Configuration

                        * ezpublish/config/security.yml
                        * HTTP Auth by default

                        ```yaml
                        ezpublish_rest:
                            pattern: ^/api/ezp/v2
                            stateless: true
                            ezpublish_http_basic:
                                realm: eZ Publish REST API

                        ```
                        * To switch to session auth, just comment out this block
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## HATEOAS

                        * Never built URIs client side
                        * Follow links provided by a previous response
                        * Need to request to root first
                    </script>
                    <aside class="notes">very close to what you do when browsing</aside>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## XML or JSON

                        * Both supported
                        * Represent the exact same thing
                        * XML is the base format
                        * Conversion to JSON with syntax rules
                        * Example with the root structure
                    </script>
                </section>

                <section data-markdown>
                <script type="text/template">
                        ## XML Root struct

                        ```xml
                        <?xml version="1.0" encoding="UTF-8"?>
                        <Root media-type="application/vnd.ez.api.Root+xml">
                          <content media-type="" href="/api/ezp/v2/content/objects"/>
                          <contentTypes media-type="application/vnd.ez.api.ContentTypeInfoList+xml" href="/api/ezp/v2/content/types"/>
                          <users media-type="application/vnd.ez.api.UserRefList+xml" href="/api/ezp/v2/user/users"/>
                          <roles media-type="application/vnd.ez.api.RoleList+xml" href="/api/ezp/v2/user/roles"/>
                          <rootLocation media-type="application/vnd.ez.api.Location+xml" href="/api/ezp/v2/content/locations//1/2"/>
                          <rootUserGroup media-type="application/vnd.ez.api.UserGroup+xml" href="/api/ezp/v2/user/groups//1/5"/>
                          <rootMediaFolder media-type="application/vnd.ez.api.Location+xml" href="/api/ezp/v2/content/locations//1/43"/>
                          <trash media-type="application/vnd.ez.api.Trash+xml" href="/api/ezp/v2/content/trash"/>
                          <sections media-type="application/vnd.ez.api.SectionList+xml" href="/api/ezp/v2/content/sections"/>
                          <views media-type="application/vnd.ez.api.RefList+xml" href="/api/ezp/v2/content/views"/>
                        </Root>
                        ```
                    </script>
                </section>

                <section data-markdown>
                <script type="text/template">
                        ## JSON Root struct

                        ```json
                        {
                          "Root": {
                            "_media-type": "application/vnd.ez.api.Root+json",
                            "roles": {"_href": "/api/ezp/v2/user/roles", "_media-type": "application/vnd.ez.api.RoleList+json"},
                            "content": {"_href": "/api/ezp/v2/content/objects", "_media-type": ""},
                            "users": {"_href": "/api/ezp/v2/user/users", "_media-type": "application/vnd.ez.api.UserRefList+json"},
                            "rootLocation": {"_href": "/api/ezp/v2/content/locations//1/2", "_media-type": "application/vnd.ez.api.Location+json"},
                            "contentTypes": {"_href": "/api/ezp/v2/content/types", "_media-type": "application/vnd.ez.api.ContentTypeInfoList+json"},
                            "views": {"_href": "/api/ezp/v2/content/views","_media-type": "application/vnd.ez.api.RefList+json"},
                            "trash": {"_href": "/api/ezp/v2/content/trash", "_media-type": "application/vnd.ez.api.Trash+json"},
                            "rootUserGroup": {"_href": "/api/ezp/v2/user/groups//1/5", "_media-type": "application/vnd.ez.api.UserGroup+json"},
                            "rootMediaFolder": {"_href": "/api/ezp/v2/content/locations//1/43", "_media-type": "application/vnd.ez.api.Location+json"},
                            "sections": {"_href": "/api/ezp/v2/content/sections", "_media-type": "application/vnd.ez.api.SectionList+json"}
                          }
                        }
                        ```
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## XML or JSON

                        * The type of input (if any) is specified in the `Content-Type` header
                            * `application/vnd.ez.api.ContentCreate+json`
                            * `application/vnd.ez.api.ContentCreate+xml`
                        * The type of output is specified in the `Accept` header
                            * `application/vnd.ez.api.Content+xml`
                            * `application/vnd.ez.api.Content+json`
                            * `application/json` works too!
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## Hands on!

                        * Command line with cURL
                            1. Get the root structure in XML and JSON
                            2. Browse the locations
                            2. Read a content and the content info
                            3. Delete a content
                            4. Create an image content
                            5. Publish the image content
                    </script>
                </section>
                <section data-markdown>
                    <script type="text/template">
                        ## Hands on!

                        * `EzSystems/EzSummerCampRestApiBundle`: build a very rough admin interface
                            1. build a tree menu
                            2. delete a content
                            3. Bonus: copy/move...
                    </script>
                </section>
				<section>
                    <h2>The end</h2>

                    <p class="end">?</p>
                </section>


			</div>
            <header>
            <h1>eZ Publish REST API</h1>
            </header>
            <footer><p>Damien Pobel &lt;dp@ez.no&gt;</p><p>eZ Summer Camp 2013</p><p>Slide <span class="page-nr">2</span></p></footer>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: false,
                rollingLinks: false,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
					// { src: 'plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
					// { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

            Reveal.addEventListener('ready', function (e) {
                var header, footer, sections;

                header = document.querySelector('.reveal header');
                footer = document.querySelector('.reveal footer');
                sections = document.querySelectorAll('.slides section');

                for (var i = 1, len = sections.length; i != len; i++) {
                    sections[i].insertBefore(header.cloneNode(true), sections[i].firstChild);
                    sections[i].appendChild(footer.cloneNode(true));
                    sections[i].querySelector('.page-nr').innerHTML = i+1;
                }

            });
		</script>

	</body>
</html>
